<html>
  <head>
    <title>Proxy generator</title>
    <style>
      .root { width: 800px; overflow: auto; }
      .frame{ width: 240px; height: 332; float: left; border: 1px solid black; margin: 5px; padding: 2px; } 
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  </head>
  <body>
    <div class="root">
    </div>
    <script>
      var cards= [ "Ambush Viper", "Angel of Flight Alabaster", "Garruk Relentless" ];
      var isdCard = {};

      var createCardDiv = function(card) {
        if(card.hasOwnProperty("names")) {
          return $.merge(
            createSingleCardDiv(isdCard[card.names[0]]),
            createSingleCardDiv(isdCard[card.names[1]])
          );
          } else {
          return createSingleCardDiv(card);
        }

      }

      var createSingleCardDiv = function(card) {
        var result = $('<div/>', {
          class: "card",
          html: [
            $("<div/>", {
              class: "name", 
              html: card.name
            }),
            $("<div/>", {
              class: "mana", 
              html: card.manaCost
            }),,
            $("<div/>", {
              class: "type", 
              html: card.type
            }),
            $("<div/>", {
              class: "text", 
              html: card.text
            }),
            card.hasOwnProperty("power") ? $("<div/>", {
              class: "pt",
              html: card.power + "/" + card.toughness
            }) : "" 
          ]
        });

        return result;
      }

      var loadContents = function() {
        for(var i = 0; i < cards.length; i++) {
          if(isdCard[cards[i]] !== "undefined") {
            var card=isdCard[cards[i]];

            $(".root").append(
              $('<div/>', {
                class: "frame",
                html: createCardDiv(card)               
              })
            );
          }
        }
      }

      var setData = function(data) {
        console.log(data);
        document.title = data.name;
    
        for(var i = 0; i < data.cards.length; i++) {
          isdCard[data.cards[i].name] = data.cards[i]; 
        }

        loadContents();
      }

      $.getJSON('ISD.json', function(data) { setData(data) });
    </script>
  </body>
</html>
